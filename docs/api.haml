!!! html
%html
  %head
    %title Poll Everywhere API
  %body
    %header
      %h1 Poll Everywhere API Documentation
      %em Disclaimer: this documentation is only intended for an internal preview. Hold off on using this stuff until we announce it on our blog.

    %section
      %p This API assumes that you are familar with the low-level semantics of HTTP, including the use of tools like cURL, and JSON.
      
      %h1 Authentication
      %p HTTP Basic authentication is currently used for logging into Poll Everywhere accounts.  

      %h1 We use JSON
      %p Simple JSON key-value data structures are used throughout the API application to persist and modify data to the web application. Typically resources will include a root key that corresponds with the name of the name of the resource; from example, multiple choice polls all have the root key 'multiple_choice_poll'.
      
      %h1 Polls
      %h2 Multiple choice polls
      %h3 JSON Attributes
      %dl
        %dt=PollEverywhere::MultipleChoicePoll.root_key
        %dd Root key for multiple choice poll data.
        %dd
          %dl
            -PollEverywhere::MultipleChoicePoll.props.each do |_, prop|
              %dt=prop.name
              %dd=prop.description
              -if prop.name == :options
                %dd
                  %dl
                    -PollEverywhere::MultipleChoicePoll::Option.props.each do |_, prop|
                      %dt=prop.name
                      %dd=prop.description

      %h3 Creating a multiple choice poll
      -@mcp = PollEverywhere::MultipleChoicePoll.from_hash(:title => 'Hey dude!', :options => %w[red blue green]).save
      %code=examples @mcp  
      
      %h3 Changing the title of the multiple choice poll
      -@mcp.title = "I like different titles"
      -@mcp.save
      %code=examples @mcp  

      %h3 Closing and opening multiple choice polls
      %p To close a poll, change the state to "closed"
      -@mcp.stop
      %code=examples @mcp
      
      %p To open it back up (and allow responses to come on through) change the state to "opened"
      -@mcp.start
      %code=examples @mcp

      %h3 Delete a multiple choice poll
      %p When you're totally finished with the poll and you want to tidy things up a bit, you can delete polls
      -@mcp.destroy
      %code=examples @mcp  

      %h2 Free text polls
      %h3 JSON Attributes
      %dl
        %dt=PollEverywhere::FTP.root_key
        %dd Root key for free text poll data.
        %dd
          %dl
            -PollEverywhere::FTP.props.each do |_, prop|
              %dt=prop.name
              %dd=prop.description

      %h3 Create free text polls
      %p Creating a free text poll is similar to building a multiple choice poll, just without the options attribute.
      -@ftp = PollEverywhere::FreeTextPoll.from_hash(:title => "What is the meaning of life?").save
      %code=examples @ftp  
      
      %h3 Modify a free text poll
      %p Change the title attribute to change the poll
      -@ftp.state = "opened"
      -@ftp.save
      %code=examples @ftp
      
      %h3 Delete a free text poll
      -@ftp.destroy
      %code=examples @ftp
    %footer
      %p
        This documentation was automatically generated by the Poll Everywhere rubygem at
        =succeed '.' do
          %a(href="http://github.com/polleverywhere/polleverywhere") http://github.com/polleverywhere/polleverywhere
        Community support for the API is available on the
        %a(href="http://groups.google.com/group/polleverywhere-dev") Poll Everywhere Developer mailing list
        and paid professional support at
        =succeed '.' do
          %a(href="http://www.polleverywhere.com/professional-support") Poll Everywhere